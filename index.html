<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Geeta Tech Hub — News Widget</title>
<style>
  :root{--gth-accent:#ff5b60;--gth-bg:#fff;--gth-muted:#777;--gth-radius:12px}
  html,body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  .gth-wrap{max-width:980px;margin:12px auto;padding:12px}
  .gth-card{background:var(--gth-bg);border-radius:var(--gth-radius);box-shadow:0 8px 24px rgba(12,14,20,.06);overflow:hidden}
  .gth-header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px}
  .gth-title{font-weight:700;font-size:18px;color:#111}
  .gth-sub{font-size:12px;color:var(--gth-muted)}
  .gth-layout{display:grid;gap:12px;padding:12px}
  .gth-featured{display:flex;gap:12px;align-items:flex-start;padding:12px;border-radius:10px;background:#fff}
  .gth-featured .img{flex:0 0 48%;max-height:260px;overflow:hidden;border-radius:10px}
  .gth-featured img{width:100%;height:100%;object-fit:cover;display:block}
  .gth-featured .meta{flex:1;display:flex;flex-direction:column;gap:8px}
  .gth-featured .headline{font-size:18px;font-weight:700;color:#111;line-height:1.15}
  .gth-featured .syn{font-size:14px;color:#222;line-height:1.4}
  .gth-featured .meta-row{display:flex;justify-content:space-between;align-items:center;color:var(--gth-muted);font-size:12px;margin-top:auto}
  .gth-featured a.read{border:1px solid var(--gth-accent);color:var(--gth-accent);padding:6px 10px;border-radius:8px;text-decoration:none;font-size:13px}
  .gth-sm-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
  .gth-sm{display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.04);background:#fff}
  .gth-sm .thumb{flex:0 0 86px;height:60px;border-radius:8px;overflow:hidden;background:#f2f2f2}
  .gth-sm img{width:100%;height:100%;object-fit:cover}
  .gth-sm .info{flex:1}
  .gth-sm .h{font-size:13px;font-weight:600;color:#111;margin-bottom:6px}
  .gth-sm .s{font-size:12px;color:var(--gth-muted)}
  .gth-footer{padding:10px 14px;font-size:12px;color:var(--gth-muted);text-align:right}
  .gth-loading{padding:24px;text-align:center;color:var(--gth-muted)}
  .gth-error{padding:20px;text-align:center;color:#b00020}
  @media(max-width:720px){.gth-featured{flex-direction:column}.gth-featured .img{width:100%;height:180px}}
</style>
</head>
<body>
<div class="gth-wrap">
  <div id="gth-root" class="gth-card" aria-label="Geeta Tech Hub News Widget">
    <div class="gth-header">
      <div>
        <div class="gth-title">Geeta Tech Hub News</div>
        <div class="gth-sub">Google News + Trending searches • quick synopses</div>
      </div>
      <div class="gth-sub">Auto • Local</div>
    </div>
    <div id="gth-content" class="gth-layout">
      <div id="gth-loading" class="gth-loading">Loading headlines…</div>
    </div>
  </div>
</div>

<script>
(async function(){
  const country = 'IN';
  const smallCount = 4;
  const newsRSS = `https://news.google.com/rss?hl=en-${country}&gl=${country}&ceid=${country}:en`;
  const trendsRSS = `https://trends.google.com/trends/trendingsearches/daily/rss?geo=${country}`;
  const proxy = url => 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);

  const root = document.getElementById('gth-content');
  const load = document.getElementById('gth-loading');

  function stripHtml(html){if(!html)return'';const d=document.createElement('div');d.innerHTML=html;return d.textContent||d.innerText||'';}
  function shortify(t,l=140){if(!t)return'';t=stripHtml(t).replace(/\s+/g,' ').trim();if(t.length<=l)return t;const s=t.slice(0,l);const end=Math.max(s.lastIndexOf('.'),s.lastIndexOf('!'),s.lastIndexOf('?'));return end>30?s.slice(0,end+1):s+'…';}
  function catchy(title,desc){const d=shortify(desc,160);const arr=[`${title} — quick take: ${d}`,`Why it matters: ${d}`,`${title} — in brief: ${d}`,`Snapshot: ${d}`];return arr[Math.floor(Math.random()*arr.length)];}
  function escapeHtml(s){return s?String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'):'';}
  function parse(xml){const p=new DOMParser();const doc=p.parseFromString(xml,"application/xml");return[...doc.querySelectorAll('item')].map(it=>{const g=q=>it.querySelector(q)?it.querySelector(q).textContent:'';let img='';const m=it.querySelector('media\\:content, media\\:thumbnail');if(m&&m.getAttribute('url'))img=m.getAttribute('url');if(!img){const e=it.querySelector('enclosure');if(e&&e.getAttribute('url'))img=e.getAttribute('url');}if(!img){const r=/<img[^>]+src=["']?([^"'>\s]+)["']?/i.exec(g('description')||g('content\\:encoded'));if(r)img=r[1];}return{title:g('title'),link:g('link')||g('guid'),content:g('content\\:encoded')||g('description'),pubDate:g('pubDate'),image:img};});}
  async function txt(url){const r=await fetch(proxy(url));if(!r.ok)throw new Error(r.statusText);return await r.text();}

  try{
    const [n,t]=await Promise.all([txt(newsRSS),txt(trendsRSS)]);
    const items=[...parse(n),...parse(t)];
    if(!items.length){root.innerHTML='<div class="gth-error">No items found.</div>';return;}
    items.sort((a,b)=>new Date(b.pubDate||0)-new Date(a.pubDate||0));
    const f=items[0];const s=items.slice(1,1+smallCount);
    const svgNoImg="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='120'><rect width='100%' height='100%' fill='%23f2f2f2'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='%23999' font-size='12'>No image</text></svg>";
    let html=`<div class='gth-featured'><div class='img'><a href='${f.link}' target='_blank'><img src='${escapeHtml(f.image||svgNoImg)}' alt=''></a></div><div class='meta'><div class='headline'><a href='${f.link}' target='_blank' style='text-decoration:none;color:inherit'>${escapeHtml(f.title)}</a></div><div class='syn'>${escapeHtml(catchy(f.title,f.content))}</div><div class='meta-row'><div>${escapeHtml(f.pubDate?new Date(f.pubDate).toLocaleString():'')}</div><div><a class='read' href='${f.link}' target='_blank'>Read full</a></div></div></div></div>`;
    html+="<div class='gth-sm-grid'>";
    for(const x of s){
      html+=`<div class='gth-sm'><div class='thumb'><a href='${x.link}' target='_blank'><img src='${escapeHtml(x.image||svgNoImg)}' alt=''></a></div><div class='info'><div class='h'><a href='${x.link}' target='_blank' style='text-decoration:none;color:inherit'>${escapeHtml(x.title)}</a></div><div class='s'>${escapeHtml(shortify(x.content,110))}</div></div></div>`;
    }
    html+="</div><div class='gth-footer'>Powered by Google News & Trends</div>";
    root.innerHTML=html;
  }catch(e){
    console.error(e);
    root.innerHTML='<div class="gth-error">Failed to load feeds (check console).</div>';
  }
})();
</script>
</body>
</html>
