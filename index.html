<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Geeta Tech Hub — News Widget</title>
  <style>
    :root{--gth-accent:#ff5b60;--gth-bg:#fff;--gth-muted:#777;--gth-radius:12px}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    .gth-wrap{max-width:980px;margin:8px auto;padding:12px}
    .gth-card{background:var(--gth-bg);border-radius:var(--gth-radius);box-shadow:0 8px 24px rgba(12,14,20,.06);overflow:hidden}
    .gth-header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px}
    .gth-title{font-weight:700;font-size:18px;color:#111}
    .gth-sub{font-size:12px;color:var(--gth-muted)}
    .gth-layout{display:grid;grid-template-columns:1fr;gap:12px;padding:12px}
    .gth-featured{display:flex;gap:12px;align-items:flex-start;padding:12px;border-radius:10px;background:#fff}
    .gth-featured .img{flex:0 0 48%;max-height:260px;overflow:hidden;border-radius:10px}
    .gth-featured img{width:100%;height:100%;object-fit:cover;display:block}
    .gth-featured .meta{flex:1;display:flex;flex-direction:column;gap:8px}
    .gth-featured .headline{font-size:18px;font-weight:700;color:#111;line-height:1.15}
    .gth-featured .syn{font-size:14px;color:#222;line-height:1.4}
    .gth-featured .meta-row{display:flex;justify-content:space-between;align-items:center;color:var(--gth-muted);font-size:12px;margin-top:auto}
    .gth-featured a.read{background:transparent;border:1px solid var(--gth-accent);color:var(--gth-accent);padding:8px 10px;border-radius:8px;text-decoration:none;font-size:13px}
    .gth-sm-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
    .gth-sm{display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.04);background:#fff}
    .gth-sm .thumb{flex:0 0 86px;height:60px;border-radius:8px;overflow:hidden;background:#f2f2f2}
    .gth-sm img{width:100%;height:100%;object-fit:cover}
    .gth-sm .info{flex:1}
    .gth-sm .h{font-size:13px;font-weight:600;color:#111;line-height:1.2;margin-bottom:6px}
    .gth-sm .s{font-size:12px;color:var(--gth-muted);line-height:1.2}
    .gth-footer{padding:10px 14px;font-size:12px;color:var(--gth-muted);text-align:right}
    .gth-loading{padding:24px;text-align:center;color:var(--gth-muted)}
    @media (max-width:720px){
      .gth-featured{flex-direction:column}
      .gth-featured .img{width:100%;height:180px}
    }
  </style>
</head>
<body>
  <div class="gth-wrap">
    <div id="gth-root" class="gth-card" role="region" aria-label="Geeta Tech Hub News Widget">
      <div class="gth-header">
        <div>
          <div class="gth-title">Geeta Tech Hub News</div>
          <div class="gth-sub">Google News + Trending searches • quick synopses</div>
        </div>
        <div class="gth-sub">Auto • Local</div>
      </div>

      <div id="gth-content" class="gth-layout">
        <div class="gth-loading">Loading headlines…</div>
      </div>
    </div>
  </div>

<script>
(function(){
  // CONFIG
  const country = 'IN';        // change to desired country code (e.g., 'US','GB')
  const smallCount = 4;        // number of small cards
  const rss2jsonBase = 'https://api.rss2json.com/v1/api.json?rss_url=';
  const newsRSS = `https://news.google.com/rss?hl=en-${country}&gl=${country}&ceid=${country}:en`;
  const trendsRSS = `https://trends.google.com/trends/trendingsearches/daily/rss?geo=${country}`;

  // helpers
  const root = document.getElementById('gth-content');
  function stripHtml(html){ if(!html) return ''; const d=document.createElement('div'); d.innerHTML = html; return d.textContent||d.innerText||''; }
  function extractImage(it){
    if(it.thumbnail) return it.thumbnail;
    if(it.enclosure && it.enclosure.link) return it.enclosure.link;
    const m1= /<img[^>]+src="([^">]+)"/i.exec(it.content||''); if(m1) return m1[1];
    const m2= /<img[^>]+src="([^">]+)"/i.exec(it.description||''); if(m2) return m2[1];
    return '';
  }
  function shortify(text,lim=140){ if(!text) return ''; text = stripHtml(text).replace(/\s+/g,' ').trim(); if(text.length<=lim) return text; const s = text.slice(0,lim); const last = Math.max(s.lastIndexOf('.'), s.lastIndexOf('!'), s.lastIndexOf('?')); return (last>30 ? s.slice(0,last+1) : s.trim() + '…'); }
  function catchy(title,desc){ const d = shortify(desc,160); const templates = [ `${title} — quick take: ${d}`, `Why it matters: ${d}`, `${title} — in brief: ${d}`, `Snapshot: ${d}` ]; return templates[Math.floor(Math.random()*templates.length)]; }
  function escapeHtml(s){ if(!s) return ''; return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

  async function fetchJson(rssUrl){
    try{
      const r = await fetch(rss2jsonBase + encodeURIComponent(rssUrl));
      if(!r.ok) throw new Error('Network error');
      return await r.json();
    }catch(e){
      console.warn('rss fetch failed', e);
      return null;
    }
  }

  (async function render(){
    root.innerHTML = '<div class="gth-loading">Loading headlines…</div>';
    const [newsJson, trendsJson] = await Promise.all([ fetchJson(newsRSS), fetchJson(trendsRSS) ]);
    const items = [];

    if(newsJson && newsJson.items){
      for(const it of newsJson.items){
        items.push({
          title: it.title,
          link: it.link,
          content: it.content || it.description,
          pubDate: it.pubDate,
          source: newsJson.feed && newsJson.feed.title,
          image: extractImage(it)
        });
      }
    }
    if(trendsJson && trendsJson.items){
      for(const it of trendsJson.items){
        items.push({
          title: it.title,
          link: it.link || '#',
          content: it.description || '',
          pubDate: it.pubDate,
          source: trendsJson.feed && trendsJson.feed.title,
          image: ''
        });
      }
    }

    if(items.length === 0){
      root.innerHTML = '<div class="gth-loading">No items available right now.</div>';
      return;
    }

    // sort by newest first
    items.sort((a,b)=>{
      const ta = a.pubDate ? new Date(a.pubDate).getTime() : 0;
      const tb = b.pubDate ? new Date(b.pubDate).getTime() : 0;
      return tb - ta;
    });

    const featured = items[0];
    const smalls = items.slice(1, 1 + smallCount);

    // build markup
    let html = '';
    html += '<div class="gth-featured">';
    if(featured.image){
      html += `<div class="img"><a href="${featured.link}" target="_blank" rel="noopener noreferrer"><img alt="${escapeHtml(featured.title)}" src="${featured.image}"></a></div>`;
    } else {
      html += `<div class="img"><a href="${featured.link}" target="_blank" rel="noopener noreferrer"><img alt="${escapeHtml(featured.title)}" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='800' height='480'><rect width='100%' height='100%' fill='%23f3f3f3'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='%23999' font-size='20'>No image</text></svg>"></a></div>`;
    }
    html += '<div class="meta">';
    html += `<div class="headline"><a href="${featured.link}" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit">${escapeHtml(featured.title)}</a></div>`;
    html += `<div class="syn">${escapeHtml(catchy(featured.title, featured.content || ''))}</div>`;
    html += `<div class="meta-row"><div class="gth-src">${escapeHtml(featured.source||'')}</div><div><a class="read" href="${featured.link}" target="_blank" rel="noopener noreferrer">Read full</a></div></div>`;
    html += '</div></div>';

    // small grid
    html += '<div class="gth-sm-grid">';
    for(const s of smalls){
      html += '<div class="gth-sm">';
      html += `<div class="thumb"><a href="${s.link}" target="_blank" rel="noopener noreferrer"><img src="${s.image || 'data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'200\\' height=\\'120\\'><rect width=\\'100%\\' height=\\'100%\\' fill=\\'%23f2f2f2\\'/><text x=\\'50%\\' y=\\'50%\\' dominant-baseline=\\'middle\\' text-anchor=\\'middle\\' fill=\\'%23999\\' font-size=\\'12\\'>No image</text></svg>'}" alt=""></a></div>`;
      html += '<div class="info">';
      html += `<div class="h"><a href="${s.link}" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit">${escapeHtml(s.title)}</a></div>`;
      html += `<div class="s">${escapeHtml(shortify(s.content||'',110))}</div>`;
      html += '</div></div>';
    }
    html += '</div><div class="gth-footer">Powered by Google News & Trends</div>';

    root.innerHTML = html;
  })();

})();
</script>
</body>
</html>
